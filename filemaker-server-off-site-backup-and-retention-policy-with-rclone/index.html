<!DOCTYPE html><html lang="en-us"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>FileMaker Server Off-Site Backup &amp; Retention Policy with rclone - Mohamed H. Tawfiq</title><meta name="description" content="Off-site backups are important in case there are issues with the main server where local backups are stored making them&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><script type="text/javascript" async src="https://www.googletagmanager.com/gtag/js?id=G-D9R3LDLNNN"></script><script type="text/javascript">window.dataLayer = window.dataLayer || [];
				  function gtag(){dataLayer.push(arguments);}
				  gtag('js', new Date());
				  gtag('config', 'G-D9R3LDLNNN' );</script><link rel="canonical" href="https://mhtawfiq.github.io/filemaker-server-off-site-backup-and-retention-policy-with-rclone/"><link rel="alternate" type="application/atom+xml" href="https://mhtawfiq.github.io/feed.xml"><link rel="alternate" type="application/json" href="https://mhtawfiq.github.io/feed.json"><meta property="og:title" content="FileMaker Server Off-Site Backup & Retention Policy with rclone"><meta property="og:image" content="https://mhtawfiq.github.io/media/posts/7/Medium1x.png"><meta property="og:image:width" content="925"><meta property="og:image:height" content="460"><meta property="og:site_name" content="Mohamed H. Tawfiq"><meta property="og:description" content="Off-site backups are important in case there are issues with the main server where local backups are stored making them&hellip;"><meta property="og:url" content="https://mhtawfiq.github.io/filemaker-server-off-site-backup-and-retention-policy-with-rclone/"><meta property="og:type" content="article"><link rel="shortcut icon" href="https://mhtawfiq.github.io/media/website/favicon.ico" type="image/x-icon"><link rel="shortcut icon" href="https://mhtawfiq.github.io/media/website/favicon.ico" type="image/x-icon"><link rel="preload" href="https://mhtawfiq.github.io/assets/dynamic/fonts/cairo/cairo.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="https://mhtawfiq.github.io/assets/dynamic/fonts/andadapro/andadapro.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="https://mhtawfiq.github.io/assets/css/style.css?v=aa904e5847e7cfa6620df5b40b3150e5"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://mhtawfiq.github.io/filemaker-server-off-site-backup-and-retention-policy-with-rclone/"},"headline":"FileMaker Server Off-Site Backup & Retention Policy with rclone","datePublished":"2023-11-28T13:52","dateModified":"2023-11-30T18:15","image":{"@type":"ImageObject","url":"https://mhtawfiq.github.io/media/posts/7/Medium1x.png","height":460,"width":925},"description":"Off-site backups are important in case there are issues with the main server where local backups are stored making them&hellip;","author":{"@type":"Person","name":"Mohamed H. Tawfiq","url":"https://mhtawfiq.github.io/authors/mohamed-h-tawfiq/"},"publisher":{"@type":"Organization","name":"Mohamed H. Tawfiq","logo":{"@type":"ImageObject","url":"https://mhtawfiq.github.io/media/website/Creative-Engineering-2.svg","height":651,"width":651}}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript><link rel="stylesheet" href="https://mhtawfiq.github.io/assets/css/prism.css?v=2af71f4b70e42eb77246baf7998704dc"></head><body><header class="header" id="js-header"><a href="https://mhtawfiq.github.io/" class="logo"><img src="https://mhtawfiq.github.io/media/website/Creative-Engineering-2.svg" alt="Mohamed H. Tawfiq" width="651" height="651"></a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://mhtawfiq.github.io/" target="_self">Home</a></li><li class="active-parent has-submenu"><a href="https://mhtawfiq.github.io/tags/claris-filemaker/" target="_self" aria-haspopup="true">Claris FileMaker</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://mhtawfiq.github.io/deploying-filemaker-server-on-ubuntu-linux-with-lets-encrypt-ssl/" target="_self">Deploying FileMaker Server on Ubuntu Linux with Let&#x27;s Encrypt SSL</a></li><li class="active"><a href="https://mhtawfiq.github.io/filemaker-server-off-site-backup-and-retention-policy-with-rclone/" target="_self">FileMaker Server Off-Site Backups with rclone</a></li></ul></li><li class="has-submenu"><a href="https://github.com/mhtawfiq" target="_blank" aria-haspopup="true">GitHub</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://github.com/mhtawfiq/FileMaker-LetsEncrypt-Ubuntu-Nginx" target="_blank">FileMaker Server Let&#x27;s Encrypt on Ubuntu</a></li><li><a href="https://github.com/mhtawfiq/filemaker-server-rclone" target="_blank">FileMaker Server rclone Off-Site backups</a></li></ul></li><li><a href="https://mhtawfiq.github.io/about/" target="_self">About</a></li><li><a href="https://mhtawfiq.github.io/contact/" target="_self">Contact</a></li></ul></nav><div class="search"><div class="search__overlay js-search-overlay"><form action="https://mhtawfiq.github.io/search.html" class="search__form"><input class="search__input" type="search" name="q" placeholder="search..." aria-label="search..." autofocus> <button type="submit" class="search__button"><span>Submit</span></button></form></div><button class="search__btn js-search-btn" aria-label="Search"><svg role="presentation" focusable="false" height="18" width="18"><use xlink:href="https://mhtawfiq.github.io/assets/svg/svg-map.svg#search"/></svg></button></div></header><main><div class="wrapper"><article class="post"><header class="post__header"><h1 class="post__title">FileMaker Server Off-Site Backup &amp; Retention Policy with rclone</h1><div class="post__meta"><time datetime="2023-11-28T13:52">November 28, 2023</time></div></header><figure class="post__featured-image"><img src="https://mhtawfiq.github.io/media/posts/7/Medium1x.png" loading="eager" height="460" width="925" alt=""></figure><div class="post__inner"><div class="post__entry"><p>Off-site backups are important in case there are issues with the main server where local backups are stored making them unrecoverable.</p><p>It allows you to restore the server and also store long term backups for archival or legal reasons while leveraging cloud storage backends scalability and multi-geographical zone availability.Â </p><p>This guide will go through how to setup and use rclone with Claris FileMaker Server on Ubuntu Linux to automate the creation and maintenance of off-site backups and maintaining a backup retention policy using Amazon S3 as an affordable, scalable and highly available storage backend.</p><h4>What is rclone?</h4><p>rclone is an open source self contained command line tool to manage cloud storage. It can sync, copy and transfer data to many storage backends including Amazon S3 and others.</p><p class="msg msg--info"><a href="https://rclone.org/overview/">rclone Overview &amp; supported storage backends</a></p><h4>Claris FileMaker Server OS</h4><p>This guide is designed for Ubuntu Linux, rclone can be used on Windows Server &amp; MacOS as well but some of the setup steps will be different.</p><h4>Download &amp; Install rclone</h4><p>Login as root via SSH to your FileMaker Server and run:</p><pre class="language-bash"><code>sudo -v ; curl https://rclone.org/install.sh | sudo bash</code></pre><p>On Windows Server, follow the instructions at:</p><p class="msg msg--info"><a href="https://rclone.org/install/#windows" target="_blank" rel="noopener noreferrer">https://rclone.org/install/#windows</a></p><h4>Setup AWS S3 Bucket &amp; Credentials</h4><ul><li>Setup an AWS account if you don't already have one and login to AWS Console as an Administrator</li><li>From <a href="https://aws.amazon.com/s3" target="_blank" rel="noopener noreferrer">AWS S3 Console</a>, create a new S3 bucket, besides selecting the AWS Region closest to your FileMaker Server you can leave all other settings as default</li><li>From AWS IAM Console, open your user page <em>(the same user used to create the s3 bucket)</em> goto "Security credentials" tab then "Access keys" section, click "Create access key"</li><li>For "Use case" select "Other", add a description and create the access key</li><li>You will only be shown the "Access key" &amp; "Secret" once, make sure you save them in a safe place</li></ul><p>In some cases, it might be worth considering creating a dedicated AWS IAM user with access to only the backup S3 bucket. Below is an article that further explains the process of how to use policies to limit access to s3 buckets:</p><p class="msg msg--info"><a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/example-walkthroughs-managing-access-example1.html" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/AmazonS3/latest/userguide/example-walkthroughs-managing-access-example1.html</a></p><h4>Configure rclone Remote</h4><p class="p1">On FileMaker Server via SSH run:</p><pre class="language-bash"><code>rclone config

# Follow on screen prompts to enter the S3 bucket details and access credentials.
# For Reference:
# provider: AWS
# en_auth: 1
# access_key_id: &lt;your_access_key_id&gt;
# secret_access_key: &lt;your_access_key_secret&gt;
# region: your s3 bucket aws region
# endpoint: leave blank
# location_constraint: same as your region
# acl: 1
# server_side_encryption: leave blank (encryption is already provided by s3)
# storage_class: 1 </code></pre><p class="msg msg--info">Reference: <a href="https://rclone.org/s3/" target="_blank" rel="noopener noreferrer">https://rclone.org/s3/</a></p><h4>Backup Retention Policy</h4><p>How long you need to keep backups for will depend on your organization's business and legal needs. In this guide we will use the following retention policy:</p><ul><li>Keep daily backups for 90 days (90 backups)</li><li>Keep weekly backups for 6 months (24 backups)</li><li>Keep Monthly backups for 3 years (36 backups)</li></ul><p>You can set these parameters along with which day to use for weekly and monthly backups in the rclone backup script further below in this article.</p><h4>FileMaker Server Backup Configuration</h4><p>This guide assumes that the default FileMaker Server Auto-Backup schedule is enabled and running as the rclone script uses the latest daily backup generated.</p><p>The idea here is that FileMaker Server handles the actual backup creation to make it's done properly then the rclone script takes over after that to create off-site copies.</p><h4>Off-Site rclone Backup Script</h4><p>The script is at my GitHub repo:</p><p class="msg msg--info"><a href="https://github.com/mhtawfiq/filemaker-server-rclone" target="_blank" rel="noopener noreferrer">https://github.com/mhtawfiq/filemaker-server-rclone</a></p><p>Follow the instructions at the repo to download and set it up and edit the variables inside the script to set rclone remote name, S3 bucket name, retention policy, weekly backup day and monthly backup day:</p><pre class="language-bash"><code># FileMaker Server Backups Folder
fmsbackupsf="/opt/FileMaker/FileMaker Server/Data/Backups"

# rclone Remote
rcr="fms-backup"

# S3 Bucket Name
s3="fms-backup1"

# Retention Policy
rdaily=90
rweekly=24
rmonthly=36

# Day of the Week for Weekly Backups
# Monday (1) to Sunday (7)
dweekly=1

# Day of the Month for Monthly Backups
dmonthly=1</code></pre><h4>Schedule rclone Script to Run Automatically</h4><p>Make sure you allow enough time for FileMaker Server default Auto-Backup to have finished creating the daily backup before running the rclone script.</p><p>On FileMaker Server via SSH, using crontab to setup the schedule:</p><pre class="language-bash"><code># Logged in as root, select nano to edit crontab
crontab -e

# Add the following line to run daily at 04:00 AM
# Press Ctrl+X then Y to exit and save.
0 4 * * * /root/fms-rclone/fms-rclone.sh

# Check Current Crontab
crontab -l</code></pre><p>In the example above, fms-rclone.sh will run at 04:00 AM daily, you can adjust this as needed using crontab syntax.</p><p class="msg msg--info">Crontab syntax: <a href="https://crontab.guru/" target="_blank" rel="noopener noreferrer">https://crontab.guru/</a></p><h4>Conclusion</h4><p>The script should now run on a daily basis copying the latest FileMaker Server Auto-Backup to AWS S3 and maintaining the backup data retention policy configured.Â </p></div><footer><p class="post__last-updated">This article was updated on November 30, 2023</p><div class="post__tags-share"><ul class="post__tag"><li><a href="https://mhtawfiq.github.io/tags/claris-filemaker/">Claris FileMaker</a></li><li><a href="https://mhtawfiq.github.io/tags/github/">github</a></li><li><a href="https://mhtawfiq.github.io/tags/rclone/">rclone</a></li></ul><aside class="post__share"><a href="https://twitter.com/share?url=https%3A%2F%2Fmhtawfiq.github.io%2Ffilemaker-server-off-site-backup-and-retention-policy-with-rclone%2F&amp;via=mhtawfiq&amp;text=FileMaker%20Server%20Off-Site%20Backup%20%26%20Retention%20Policy%20with%20rclone" class="js-share twitter" aria-label="Share with Twitter" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://mhtawfiq.github.io/assets/svg/svg-map.svg#twitter"/></svg> </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fmhtawfiq.github.io%2Ffilemaker-server-off-site-backup-and-retention-policy-with-rclone%2F" class="js-share linkedin" aria-label="Share with LinkedIn" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://mhtawfiq.github.io/assets/svg/svg-map.svg#linkedin"/></svg> </a><a href="https://api.whatsapp.com/send?text=FileMaker%20Server%20Off-Site%20Backup%20%26%20Retention%20Policy%20with%20rclone https%3A%2F%2Fmhtawfiq.github.io%2Ffilemaker-server-off-site-backup-and-retention-policy-with-rclone%2F" class="js-share whatsapp" aria-label="Share with WhatsApp" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://mhtawfiq.github.io/assets/svg/svg-map.svg#whatsapp"/></svg></a></aside></div></footer></div></article></div></main><footer class="footer"><div class="footer__social"><a href="https://mobile.twitter.com/mhtawfiq" aria-label="Twitter" class="twitter"><svg><use xlink:href="https://mhtawfiq.github.io/assets/svg/svg-map.svg#twitter"/></svg> </a><a href="https://www.instagram.com/mhtawfiq_/" aria-label="Instagram" class="instagram"><svg><use xlink:href="https://mhtawfiq.github.io/assets/svg/svg-map.svg#instagram"/></svg> </a><a href="https://www.linkedin.com/in/mhtawfiq/" aria-label="LinkedIn" class="linkedin"><svg><use xlink:href="https://mhtawfiq.github.io/assets/svg/svg-map.svg#linkedin"/></svg></a></div><div class="footer__copyright">mhtawfiq - all rights reserved</div></footer><script>window.publiiThemeMenuConfig = {    
      mobileMenuMode: 'sidebar',
      animationSpeed: 300,
      submenuWidth: 'auto',
      doubleClickTime: 500,
      mobileMenuExpandableSubmenus: true, 
      relatedContainerForOverlayMenuSelector: '.navbar',
   };</script><script defer="defer" src="https://mhtawfiq.github.io/assets/js/scripts.min.js?v=66112a161d5939d966ce2b20c13988d9"></script><script>var images = document.querySelectorAll('img[loading]');

      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
               images[i].classList.add('is-loaded');
         } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
               }, false);
         }
      }</script><script defer="defer" src="https://mhtawfiq.github.io/assets/js/prism.js?v=8a0e010f68c5902e636b8157675289a3"></script></body></html>