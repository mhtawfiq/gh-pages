{
    "version": "https://jsonfeed.org/version/1",
    "title": "Mohamed H. Tawfiq",
    "description": "",
    "home_page_url": "https://mhtawfiq.github.io",
    "feed_url": "https://mhtawfiq.github.io/feed.json",
    "user_comment": "",
    "icon": "https://mhtawfiq.github.io/media/website/Creative-Engineering-2.svg",
    "author": {
        "name": "Mohamed H. Tawfiq"
    },
    "items": [
        {
            "id": "https://mhtawfiq.github.io/practical-guide-for-filemaker-server-on-ubuntu-linux-server-with-lets-encrypt-ssl-deployment/",
            "url": "https://mhtawfiq.github.io/practical-guide-for-filemaker-server-on-ubuntu-linux-server-with-lets-encrypt-ssl-deployment/",
            "title": "Deploying FileMaker Server on Ubuntu Linux with Let&#x27;s Encrypt SSL",
            "summary": "While I am used to deploying Claris FileMaker Server on Windows Server, I recently needed to do a deployment on&hellip;",
            "content_html": "\n  <p>\n    While I am used to deploying Claris FileMaker Server on Windows Server, I recently needed to do a deployment on linux for the first time. I created this guide as practical reference as I went about the process. I hope you find it useful.\n  </p>\n\n    <h4 id=\"ubuntu-linux\">\n      Ubuntu Linux\n    </h4>\n\n  <p>\n    As of FileMaker Server 19.6.3 deployment on linux is supported on Ubuntu 20.xx LTS (Long Term Support) Server.\n  </p>\n\n  <p class=\"msg msg--info align-center\">\n    <a href=\"https://support.claris.com/s/article/FileMaker-Server-operating-system-requirements-all-versions-1503692927810?language=en_US\" target=\"_blank\" class=\"\" data-link-popup-id=\"1676900445123\">FileMaker Server operating system requirements - all versions</a>\n  </p>\n\n  <p>\n    <b>Using Ubuntu provides several advantages:</b>\n  </p>\n\n  <ul>\n    <li>Cost savings on Windows Server licenses</li><li>Better Performance</li><li>Faster deployment, easier automation and maintenance&nbsp;</li>\n  </ul>\n\n    <h4 id=\"cloud-hosting-provider\">\n      Cloud hosting provider\n    </h4>\n\n  <p>\n    You can use any cloud hosting provider that provides Ubuntu Linux instances including Amazon Web Services, I have had good experiences with the following providers and prefer them as their pricing and management interfaces are better:\n  </p>\n\n  <ul>\n    <li><a href=\"https://www.hetzner.com/cloud\" target=\"_blank\">Hetzner</a></li><li><a href=\"https://www.vultr.com/\" target=\"_blank\">Vultr</a></li>\n  </ul>\n\n  <p>\n    Both have multiple geographical locations and support creating a cloud defined network firewall which we will come back to later in this guide.\n  </p>\n\n    <h4 id=\"generate-ssh-key\">\n      Generate SSH key\n    </h4>\n\n  <p>\n    While you can connect to the Linux server using username and password, It's strongly recommended to use public key authentication for security.\n  </p>\n\n    <figure class=\"post__image post__image--center\">\n      <img loading=\"lazy\" src=\"https://mhtawfiq.github.io/media/posts/4/SCR-20230220-o1o.png\" height=\"588\" width=\"985\" alt=\"\" />\n      <figcaption>SSH Key Generation Overview</figcaption>\n    </figure>\n\n  <p>\n    On MacOS, open Terminal and type the following using your email address:\n  </p>\n<pre class=\"line-numbers  language-bash\"><code>ssh-keygen -t ed25519 -C \"username@domain.com\"</code></pre>\n\n  <p>\n    You will prompted to enter a path and filename for the key or accept the default, you can press enter when prompted for a password to skip it, two files will be created at the following path by default:\n  </p>\n\n  <ul>\n    <li>~/.ssh/id_ed25519 (private key)</li><li>~/.ssh/id_ed25519.pub (public key)</li>\n  </ul>\n<pre class=\"line-numbers  language-bash\"><code>cat ~/.ssh/id_ed25519.pub\nssh-ed25519 AAAC3NzaC11ZDI1NTE5AAAAIAIeaLEXiTPi5X7+MIT1peMIChRYpsHy 2IOUs+186 username@domain.com\n</code></pre>\n\n  <p>\n    Will display the contents of your public key so you can copy it the clipboard.\n  </p>\n\n  <p>\n    To generate an ssh key pair on Windows, you can use <a href=\"https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html\" target=\"_blank\">putty</a>. This <a href=\"https://www.vultr.com/docs/how-do-i-generate-ssh-keys/\" target=\"_blank\">article</a> has more information.\n  </p>\n\n    <h4 id=\"deploy-server-instance\">\n      Deploy server instance\n    </h4>\n\n  <p>\n    On your cloud hosting provider deploy the new server instance and select the size the of the instance based on the number of your users and server workload:\n  </p>\n\n  <ul>\n    <li><a href=\"https://support.claris.com/s/article/Claris-FileMaker-19-4-19-6-Technical-Specifications?language=en_US\" target=\"_blank\">Claris FileMaker 19.4 - 19.6 Technical Specifications</a><br></li><li><a href=\"https://support.claris.com/s/article/General-hardware-considerations-for-FileMaker-Server-1503692984025?language=en_US\" target=\"_blank\">General hardware considerations for FileMaker Server</a><br></li>\n  </ul>\n\n  <p>\n    The minimum is 4xCPU cores and 8xGB RAM, fast SSD storage is highly recommended. Select Ubuntu 20.xx LTS as operating system.\n  </p>\n\n  <p class=\"msg msg--highlight\">\n    During deployment you will be asked to paste your ssh public key created earlier.\n  </p>\n\n  <p class=\"msg msg--info\">\n    Once the server is running and assigned an IP, assign a subdomain to the server IP via your DNS provider or domain registrar.\n  </p>\n\n  <p>\n    In this guide we will use <mark>fms.domain.com</mark> as an example.\n  </p>\n\n    <h4 id=\"login-to-the-new-server\">\n      Login to the new server\n    </h4>\n\n  <p>\n    To login using your private key generated earlier, type the following in Terminal with the correct path and filename for your private key:\n  </p>\n<pre class=\"line-numbers  language-bash\"><code># Login as root\nssh root@fms.domain.com -i ~/.ssh/id_ed25519</code></pre>\n\n    <h4 id=\"installing-filemaker-server\">\n      Installing FileMaker Server\n    </h4>\n\n  <p class=\"msg msg--success\">\n    Get the latest FileMaker Server for Ubuntu download url from your Electronic Software Download Page provided by Claris.&nbsp;\n  </p>\n\n  <p class=\"align-center\">\n    <a href=\"https://help.claris.com/en/server-installation-configuration-guide/content/installing-single-machine-linux.html\" target=\"_blank\">Official Documentation for reference</a>\n  </p>\n<pre class=\"line-numbers  language-bash\"><code># Update Ubuntu, run this multiple times until there are no more updates\napt update && apt upgrade\n\n# Check & confirm Ubunto version\nlsb_release -a\n\n# Install needed packages\napt install wget\napt install unzip\n\n# Install FileMaker Server\ncd ~/\nmkdir fminstaller\ncd fminstaller\n\n# Download and unzip\nwget https://downloads.claris.com/esd/fms_19.6.3.302_Ubuntu20.zip\nunzip https://downloads.claris.com/esd/fms_19.6.3.302_Ubuntu20.zip\n\n# Identify installation filename\nls filemaker*.deb\n\n# Start installation\nsudo apt install ./filemaker-server-19.6.3.302-amd64.deb\n\n# Follow prompts during installation for license, type and admin credentials\n\n# Check & confirm FileMaker Server & Nginx are running\nps -A | grep fm\nps -A | grep nginx</code></pre>\n\n  <p>\n    At this point you should have FileMaker Server up and running.\n  </p>\n\n    <h4 id=\"lets-encrypt-ssl-amp-certbot\">\n      Let's Encrypt SSL &amp; Certbot\n    </h4>\n\n  <p class=\"align-center\">\n    <a href=\"https://certbot.eff.org/instructions?ws=nginx&amp;os=ubuntufocal\" target=\"_blank\">Official Certbot Documentation for reference</a>\n  </p>\n\n  <p>\n    Next we will install certbot to generate a Let's Encrypt SSL certificate and setup auto renew as LE certificates expire every 90 days.\n  </p>\n\n  <p class=\"msg msg--info\">\n    <a href=\"https://github.com/mhtawfiq/FileMaker-LetsEncrypt-Ubuntu-Nginx\" target=\"_blank\">https://github.com/mhtawfiq/FileMaker-LetsEncrypt-Ubuntu-Nginx</a>\n  </p>\n\n  <p>\n    Follow the instructions at my GitHub repository above to install certbot and download the necessary scripts to generate the SSL certificate for the first time and manage automatic renewal.\n  </p>\n\n  <p>\n    The scripts will allow you set up a specific time of the day when FileMaker Server can be restarted after a certificate renewal.\n  </p>\n\n  <p>\n    Check certbot timers and confirm they are running:\n  </p>\n\n    <figure class=\"post__image post__image--center\">\n      <img loading=\"lazy\" src=\"https://mhtawfiq.github.io/media/posts/4/SCR-20230221-32b.png\" height=\"829\" width=\"1369\" alt=\"\" />\n      <figcaption>certbot timers run twice daily at a random hour</figcaption>\n    </figure>\n\n  <p>\n    The systemctl timers installed by certbot by default check twice a day at a random time if the certificate needs to be renewed, only if the certificate is renewed will it run pre and post hooks for additional processing.\n  </p>\n\n  <p>\n    Using certbot post hooks insures that once the certificate is renewed by the timers, FileMaker Server will only restart at the time scheduled in <b>renew-cert-at.sh</b> to avoid disruption of access to users at an undesired time.\n  </p>\n\n    <h4 id=\"data-amp-plugins\">\n      Data &amp; Plugins\n    </h4>\n\n  <p>\n    The easiest way to transfer databases and files is using an sftp client like <a href=\"https://binarynights.com/\" target=\"_blank\">Forklift</a> or <a href=\"https://filezilla-project.org/\" target=\"_blank\">FileZilla</a> to connect to the server and transfer files.\n  </p>\n<pre class=\"line-numbers  language-bash\"><code># Databases Path\n/opt/FileMaker/FileMaker Server/Data/Databases/\n\n# Database Engine Plugins Path\n/opt/FileMaker/FileMaker Server/Database Server/Extensions/\n\n# Custom Web Publishing Plugins Path\n/opt/FileMaker/FileMaker Server/Web Publishing/publishing-engine/cwpc/Plugins/\n\n# FileMaker Data API Plugins Path\n/opt/FileMaker/FileMaker Server/Web Publishing/publishing-engine/wip/Plugins/</code></pre>\n\n    <h4 id=\"restarting-filemaker-server-services\">\n      Restarting FileMaker Server services\n    </h4>\n\n  <p>\n    Commands below show how to restart all or some of FileMaker Server services when needed after a plugin installation for example.\n  </p>\n<pre class=\"line-numbers  language-bash\"><code># Start & stop all services\nservice fmshelper stop\nservice fmshelper start\n\n# Restart Scripting Engine\nfmsadmin restart fmse\n\n# Restart Web Publishig Engine \nfmsadmin restart wpe\n\n# Restart Data API\nfmsadmin restart fmdapi\n</code></pre>\n\n    <h4 id=\"filemaker-server-admin-console\">\n      FileMaker Server Admin Console\n    </h4>\n\n  <p>\n    You should now be able to access and login to FileMaker Server Admin Console with SSL encryption at:\n  </p>\n\n  <p class=\"msg msg--info\">\n    https://fms.domain.com/admin-console\n  </p>\n\n    <h4 id=\"firewall\">\n      Firewall\n    </h4>\n\n  <p>\n    The final step is to secure the server with firewall rules only allowing necessary access, I prefer to do this using the hosting provider cloud defined network firewall. This offloads some load from the server as the firewall acts at the network level before reaching the server.\n  </p>\n\n  <p>\n    This also allows you to apply the same firewall rules to multiple servers <i>(development, staging, production)</i> easily.\n  </p>\n\n  <p>\n    <a href=\"https://docs.hetzner.com/cloud/firewalls/getting-started/creating-a-firewall/\" target=\"_blank\">Hetzner</a>, <a href=\"https://www.vultr.com/docs/vultr-firewall/\" target=\"_blank\">Vultr</a> and <a href=\"https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html\" target=\"_blank\">AWS</a> all support defining cloud network firewall rules, follow the links to documentation on how to set it up for each provider.\n  </p>\n\n    <figure class=\"post__image post__image--center\">\n      <img loading=\"lazy\" src=\"https://mhtawfiq.github.io/media/posts/4/Screenshot-2023-02-21-at-4.04.47-AM-2.png\" height=\"873\" width=\"1267\" alt=\"\" />\n      <figcaption>FileMaker Server Firewall Rules setup on Vultr</figcaption>\n    </figure>\n\n  <p>\n    What is important adding the rules to allow only necessary access:\n  </p>\n\n  <p class=\"msg msg--info align-center\">\n    <a href=\"https://help.claris.com/en/server-installation-configuration-guide/content/ports-used-by-server.html\" target=\"_blank\">Ports used by FileMaker Server</a>\n  </p>\n\n  <p>\n    <b>FileMaker Server Firewall needed rules overview:</b><br>\n  </p>\n<pre class=\"line-numbers  language-html\"><code>accept TCP 22   (SSH) 0.0.0.0/0\t\naccept TCP 80   (HTTP) 0.0.0.0/0\t\naccept TCP 443  (HTTPS) 443 0.0.0.0/0\t\naccept TCP 2399 (ODBC) 0.0.0.0/0\t\naccept TCP 5003 (FileMaker Clients) 0.0.0.0/0\n</code></pre>\n\n  <p>\n    If you would still like to use a software firewall on the server itself, <b>ufw</b> comes installed by default on Ubuntu, you can set it up as follows:\n  </p>\n<pre class=\"line-numbers  language-bash\"><code># Check Status\nsudo ufw status\n\n# Add rules\nsudo ufw allow 22\nsudo ufw allow 80\nsudo ufw allow 443\nsudo ufw allow 2399\nsudo ufw allow 5003\n\n# Enable Firewall\nsudo ufw enable\n\n# Disable Firewall\nsudo ufw disable</code></pre>",
            "image": "https://mhtawfiq.github.io/media/posts/4/Medium1x.png",
            "author": {
                "name": "Mohamed H. Tawfiq"
            },
            "tags": [
                   "Claris FileMaker"
            ],
            "date_published": "2023-02-20T01:26:18+03:00",
            "date_modified": "2023-02-21T14:08:15+03:00"
        }
    ]
}
